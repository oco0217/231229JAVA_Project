<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>컴퓨터가 숫자 0~9까지 중복되지않는 정수 3개를 랜덤으로 출제 맞추는 게임</h1>
    <ul>
        <li>세자리의 숫자는 중복되면 안됨.(각 숫자는 자리수를 갖고있음)</li>
        <li>각 자리수와 입력한 숫자가 일치하면 1Strike(스트라이크)</li>
        <li>숫자만 포함되어 있으면 1Ball(볼)</li>
        <li>숫자가 전혀 없으면 out(아웃)</li>
        <li>3 스트라이크면 게임 종료</li>
    </ul>
    <hr>
    <button id="start">게임 시작</button>
    <h1 id="createNumPrint"></h1>
    숫자입력 : <input type="text" id="inputNumber">
    <button id="checkGame">게임확인</button>
    <ol id="result"></ol>
</body>
<script>
    let comNum = [];
    let createCount = 1;
    document.getElementById('start').addEventListener('click', () => { //게임시작 클릭시
        if(comNum.length == 3){
            document.getElementById('createNumPrint').innerText = `컴퓨터가 숫자를 다시 생성했습니다 X${createCount}`; 
            comNum=[];
            createCount++;
        }else{
            document.getElementById('createNumPrint').innerText = '컴퓨터가 숫자를 결정했습니다.'; 
        }
        comNum.splice(0,comNum.length);
        const setComNum = new Set();
        while(setComNum.size<3){
            setComNum.add(Math.floor(Math.random() * 10));
        }
        for(val of setComNum){
            comNum.push(val);
        }
        document.getElementById('result').innerHTML = '';
        console.log(comNum);
    });
    
    document.getElementById('checkGame').addEventListener('click',()=>{//게임확인 클릭시
        let inputVal = document.getElementById('inputNumber');
        const myNum = [];
        const setMyNum = new Set();
        let print = document.getElementById('createNumPrint');
        
        if(comNum.length == 0){
            alert('게임을 시작하시려면 게임 시작 버튼을 누르고 진행해주세요.');
            inputVal.value = '';
            return;
        }
        for(let i=0; i<inputVal.value.length; i++){
            setMyNum.add(inputVal.value.substr(i,1));
        }
        inputVal.value = '';
        for(val of setMyNum){
            if((/([^\d])/).test(val)){
                print.innerHTML = `문자 또는 공백을 포함하실 수 없습니다. 숫자만 입력해주세요.`;
                return;
            }
            // else if((/([\s])/).test(val)){
            //     print.innerHTML = `공백은 포함 할 수 없습니다. 공백을 제거하고 입력해주세요.`;
            //     return;
            // }
            else if(setMyNum.size != 3){
                print.innerHTML = `숫자는 중복으로 입력하거나 숫자 3개를 초과 하실 수 없습니다.`;
                return;
            }else{
                myNum.push(val);
            }
        }
        print.innerHTML = `숫자 ${myNum}를 입력하셨습니다.`;
        numberComparison(myNum);
    });
    
    function numberComparison(myNumber) {  
        const result = document.getElementById('result');
        let strike = 0;
        let ball = 0;
        
        for (let i = 0; i < comNum.length; i++) {
            if (comNum[i] == myNumber[i]) {
                strike++;
            }
            for (let j = 0; j < myNumber.length; j++) {
                if (comNum[i] == myNumber[j] && comNum[i] != myNumber[i]) {
                    ball++;
                }
            }
        }
        
        if(strike == 0 && ball == 0){ // 아웃일경우
            result.innerHTML += `<li>!!OUT!!</li>`;
            return;
        }
    
        if(strike == 3){ //맞췄을 경우 컴퓨터값 초기화
            result.innerHTML += `<li>${myNumber} => Success! 축하드려요~ 정수 3개를 다맞추셨습니다~</li><h4>다시 시작하시려면 게임 시작을 클릭해주세요.</h4>`;
            document.getElementById('createNumPrint').innerHTML = '';
            comNum = [];
            createCount = 1;
            return;
        }
    
        result.innerHTML += `<li>${myNumber} => ${strike}Strike, ${ball}Ball</li>`;
        console.log(strike);
        console.log(ball);
    }  
</script>

</html>